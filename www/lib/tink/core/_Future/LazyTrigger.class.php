<?php

// Generated by Haxe 3.4.7
class tink_core__Future_LazyTrigger extends tink_core_FutureTrigger {
	public function __construct($op) {
		if(!php_Boot::$skip_constructor) {
		$GLOBALS['%s']->push("tink.core._Future.LazyTrigger::new");
		$__hx__spos = $GLOBALS['%s']->length;
		if($op === null) {
			throw new HException("invalid argument");
		}
		$this->op = $op;
		parent::__construct();
		$GLOBALS['%s']->pop();
	}}
	public $op;
	public function eager() {
		$GLOBALS['%s']->push("tink.core._Future.LazyTrigger::eager");
		$__hx__spos = $GLOBALS['%s']->length;
		if($this->op !== null) {
			$op = (property_exists($this, "op") ? $this->op: array($this, "op"));
			$this->op = null;
			tink_core__Callback_Callback_Impl_::invoke($op, (property_exists($this, "trigger") ? $this->trigger: array($this, "trigger")));
		}
		{
			$GLOBALS['%s']->pop();
			return $this;
		}
		$GLOBALS['%s']->pop();
	}
	public function map($f) {
		$GLOBALS['%s']->push("tink.core._Future.LazyTrigger::map");
		$__hx__spos = $GLOBALS['%s']->length;
		$_gthis = $this;
		if($this->op === null) {
			$tmp = parent::map($f);
			$GLOBALS['%s']->pop();
			return $tmp;
		} else {
			$tmp = tink_core__Future_Future_Impl_::async(array(new _hx_lambda(array(&$_gthis, &$f), "tink_core__Future_LazyTrigger_0"), 'execute'), true);
			$GLOBALS['%s']->pop();
			return $tmp;
		}
		$GLOBALS['%s']->pop();
	}
	public function flatMap($f) {
		$GLOBALS['%s']->push("tink.core._Future.LazyTrigger::flatMap");
		$__hx__spos = $GLOBALS['%s']->length;
		$_gthis = $this;
		if($this->op === null) {
			$tmp = parent::flatMap($f);
			$GLOBALS['%s']->pop();
			return $tmp;
		} else {
			$tmp = tink_core__Future_Future_Impl_::async(array(new _hx_lambda(array(&$_gthis, &$f), "tink_core__Future_LazyTrigger_1"), 'execute'), true);
			$GLOBALS['%s']->pop();
			return $tmp;
		}
		$GLOBALS['%s']->pop();
	}
	public function handle($cb) {
		$GLOBALS['%s']->push("tink.core._Future.LazyTrigger::handle");
		$__hx__spos = $GLOBALS['%s']->length;
		$this->eager();
		{
			$tmp = parent::handle($cb);
			$GLOBALS['%s']->pop();
			return $tmp;
		}
		$GLOBALS['%s']->pop();
	}
	public function __call($m, $a) {
		if(isset($this->$m) && is_callable($this->$m))
			return call_user_func_array($this->$m, $a);
		else if(isset($this->__dynamics[$m]) && is_callable($this->__dynamics[$m]))
			return call_user_func_array($this->__dynamics[$m], $a);
		else if('toString' == $m)
			return $this->__toString();
		else
			throw new HException('Unable to call <'.$m.'>');
	}
	function __toString() { return 'tink.core._Future.LazyTrigger'; }
}
function tink_core__Future_LazyTrigger_0(&$_gthis, &$f, $cb) {
	{
		$GLOBALS['%s']->push("tink.core._Future.LazyTrigger::map@405");
		$__hx__spos = $GLOBALS['%s']->length;
		$_gthis->handle(array(new _hx_lambda(array(&$cb, &$f), "tink_core__Future_LazyTrigger_2"), 'execute'));
		$GLOBALS['%s']->pop();
	}
}
function tink_core__Future_LazyTrigger_1(&$_gthis, &$f, $cb) {
	{
		$GLOBALS['%s']->push("tink.core._Future.LazyTrigger::flatMap@412");
		$__hx__spos = $GLOBALS['%s']->length;
		$_gthis->handle(array(new _hx_lambda(array(&$cb, &$f), "tink_core__Future_LazyTrigger_3"), 'execute'));
		$GLOBALS['%s']->pop();
	}
}
function tink_core__Future_LazyTrigger_2(&$cb, &$f, $v) {
	{
		$GLOBALS['%s']->push("tink.core._Future.LazyTrigger::handle@406");
		$__hx__spos = $GLOBALS['%s']->length;
		$tmp = call_user_func_array($f, array($v));
		call_user_func_array($cb, array($tmp));
		$GLOBALS['%s']->pop();
	}
}
function tink_core__Future_LazyTrigger_3(&$cb, &$f, $v) {
	{
		$GLOBALS['%s']->push("tink.core._Future.LazyTrigger::handle@413");
		$__hx__spos = $GLOBALS['%s']->length;
		call_user_func_array($f, array($v))->handle($cb);
		$GLOBALS['%s']->pop();
	}
}
